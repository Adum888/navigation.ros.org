

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>(STVL) Using an External Costmap Plugin &mdash; Navigation 2 1.0.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon-48x48.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'1.0.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Writing a New Costmap2D Plugin" href="writing_new_costmap2d_plugin.html" />
    <link rel="prev" title="(SLAM) Navigating While Mapping" href="navigation2_with_slam.html" />

<link rel="stylesheet" href="../../_static/tcs_theme.css" type="text/css" />


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Navigation 2
          

          
            
            <img src="../../_static/logo_white_200w.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#running-the-example">Running the Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#navigating">Navigating</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../build_instructions/index.html">Build and Install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../build_instructions/index.html#install">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../build_instructions/index.html#build">Build</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../build_instructions/index.html#build-navigation2-for-released-distribution">Build Navigation2 For Released Distribution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../build_instructions/index.html#install-ros">Install ROS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../build_instructions/index.html#build-navigation2">Build Navigation2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../build_instructions/index.html#quickstart-build-master">Quickstart Build Master</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../build_instructions/index.html#steps">Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../build_instructions/index.html#options">Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../build_instructions/index.html#manually-build-master">Manually Build Master</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../build_instructions/index.html#build-ros-2-master">Build ROS 2 Master</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../build_instructions/index.html#build-navigation2-dependencies">Build Navigation2 Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../build_instructions/index.html#build-navigation2-master">Build Navigation2 Master</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../build_instructions/index.html#docker">Docker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../build_instructions/index.html#building-docker-container">Building Docker Container</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../build_instructions/index.html#using-dockerhub-container">Using DockerHub Container</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../build_instructions/index.html#generate-doxygen">Generate Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../build_instructions/index.html#help">Help</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../build_instructions/build_docs/build_troubleshooting_guide.html">Build Troubleshooting Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../build_instructions/build_docs/build_troubleshooting_guide.html#common-navigation2-dependencies-build-failures">Common Navigation2 Dependencies Build Failures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../build_instructions/build_docs/build_troubleshooting_guide.html#reporting-issue">Reporting Issue</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/index.html">Navigation Concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/index.html#ros2">ROS2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#action-server">Action Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#lifecycle-nodes">Lifecycle Nodes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/index.html#behavior-trees">Behavior Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/index.html#navigation-servers">Navigation Servers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#planner-controller-and-recovery-servers">Planner, Controller, and Recovery Servers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#planners">Planners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#controllers">Controllers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#recoveries">Recoveries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/index.html#state-estimation">State Estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#standards">Standards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#global-positioning-localization-and-slam">Global Positioning: Localization and SLAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#odometry">Odometry</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/index.html#environmental-representation">Environmental Representation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#costmaps-and-layers">Costmaps and Layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/index.html#other-forms">Other Forms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="navigation2_on_real_turtlebot3.html">Navigating with a Physical Turtlebot 3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="navigation2_on_real_turtlebot3.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="navigation2_on_real_turtlebot3.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="navigation2_on_real_turtlebot3.html#tutorial-steps">Tutorial Steps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="navigation2_on_real_turtlebot3.html#setup-your-enviroment-variables">0- Setup Your Enviroment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="navigation2_on_real_turtlebot3.html#launch-turtlebot-3">1- Launch Turtlebot 3</a></li>
<li class="toctree-l4"><a class="reference internal" href="navigation2_on_real_turtlebot3.html#launch-navigation2">2- Launch Navigation2</a></li>
<li class="toctree-l4"><a class="reference internal" href="navigation2_on_real_turtlebot3.html#launch-rviz">3-  Launch RVIZ</a></li>
<li class="toctree-l4"><a class="reference internal" href="navigation2_on_real_turtlebot3.html#initialize-the-location-of-turtlebot-3">4- Initialize the Location of Turtlebot 3</a></li>
<li class="toctree-l4"><a class="reference internal" href="navigation2_on_real_turtlebot3.html#send-a-goal-pose">5-  Send a Goal Pose</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="navigation2_with_slam.html">(SLAM) Navigating While Mapping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="navigation2_with_slam.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="navigation2_with_slam.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="navigation2_with_slam.html#tutorial-steps">Tutorial Steps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="navigation2_with_slam.html#launch-robot-interfaces">0- Launch Robot Interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="navigation2_with_slam.html#launch-navigation2">1- Launch Navigation2</a></li>
<li class="toctree-l4"><a class="reference internal" href="navigation2_with_slam.html#launch-slam">2- Launch SLAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="navigation2_with_slam.html#working-with-slam">3- Working with SLAM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">(STVL) Using an External Costmap Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#costmap2d-and-stvl">Costmap2D and STVL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tutorial-steps">Tutorial Steps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setup">0- Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-stvl">1- Install STVL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modify-navigation2-parameter">1- Modify Navigation2 Parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#launch-navigation2">2- Launch Navigation2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rviz">3-  RVIZ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="writing_new_costmap2d_plugin.html">Writing a New Costmap2D Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="writing_new_costmap2d_plugin.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="writing_new_costmap2d_plugin.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="writing_new_costmap2d_plugin.html#tutorial-steps">Tutorial Steps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writing_new_costmap2d_plugin.html#write-a-new-costmap2d-plugin">1- Write a new Costmap2D plugin</a></li>
<li class="toctree-l4"><a class="reference internal" href="writing_new_costmap2d_plugin.html#export-and-make-gradientlayer-plugin">2- Export and make GradientLayer plugin</a></li>
<li class="toctree-l4"><a class="reference internal" href="writing_new_costmap2d_plugin.html#enable-the-plugin-in-costmap2d">3- Enable the plugin in Costmap2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="writing_new_costmap2d_plugin.html#run-gradientlayer-plugin">4- Run GradientLayer plugin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="writing_new_nav2planner_plugin.html">Writing a New Planner Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="writing_new_nav2planner_plugin.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="writing_new_nav2planner_plugin.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="writing_new_nav2planner_plugin.html#tutorial-steps">Tutorial Steps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writing_new_nav2planner_plugin.html#creating-a-new-planner-plugin">1- Creating a new Planner Plugin</a></li>
<li class="toctree-l4"><a class="reference internal" href="writing_new_nav2planner_plugin.html#exporting-the-planner-plugin">2- Exporting the planner plugin</a></li>
<li class="toctree-l4"><a class="reference internal" href="writing_new_nav2planner_plugin.html#pass-the-plugin-name-through-params-file">3- Pass the plugin name through params file</a></li>
<li class="toctree-l4"><a class="reference internal" href="writing_new_nav2planner_plugin.html#run-straightline-plugin">4- Run StraightLine plugin</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration/index.html">Configuration Guidelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../configuration/configuring-the-controller.html">Configuring The Controller</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/configuring-the-controller.html#controller-server">Controller Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../configuration/configuring-the-controller.html#parameters">Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/configuring-the-controller.html#progress-checker">Progress Checker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../configuration/configuring-the-controller.html#id2">Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/configuring-the-controller.html#dwb-controller">DWB Controller</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../configuration/configuring-the-controller.html#id3">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../configuration/configuring-the-controller.html#additional-parameters">Additional Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/configuring-the-controller.html#debug-parameters">Debug Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/configuring-the-controller.html#dwb-plugins">DWB Plugins</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../configuration/dwb-plugins/trajectory-generators.html">Trajectory Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../configuration/dwb-plugins/trajectory-critics.html">Trajectory Critics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../configuration/dwb-plugins/goal-checkers.html">Goal Checkers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../configuration/params/tunable-params.html">Tunable Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/params/tunable-params.html#amcl">AMCL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/params/tunable-params.html#controller-server">Controller Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/params/tunable-params.html#local-costmap">Local Costmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/params/tunable-params.html#planner-server">Planner Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/params/tunable-params.html#global-costmap">Global Costmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/params/tunable-params.html#map-server">Map Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/params/tunable-params.html#recovery-server">Recovery Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/params/tunable-params.html#bt-navigator">BT Navigator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/index.html">Navigation Plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../plugins/index.html#costmap-layers">Costmap Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins/index.html#controllers">Controllers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins/index.html#planners">Planners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins/index.html#recoveries">Recoveries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins/index.html#behavior-tree-nodes">Behavior Tree Nodes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../migration/index.html">Migration Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../migration/Dashing.html">Dashing to Eloquent</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../migration/Dashing.html#new-packages">New Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../migration/Dashing.html#new-plugins">New Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../migration/Dashing.html#navigation2-architectural-changes">Navigation2 Architectural Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../migration/Eloquent.html">Eloquent to Foxy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../migration/Eloquent.html#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../migration/Eloquent.html#server-updates">Server Updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../migration/Eloquent.html#new-plugins">New Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../migration/Eloquent.html#map-server-re-work">Map Server Re-Work</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Getting Involved</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/index.html#id1">Getting Involved</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/index.html#process">Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/index.html#licensing">Licensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/index.html#developer-certification-of-origin-dco">Developer Certification of Origin (DCO)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About and Contact</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about/robots.html">Robots Using</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/ros1_comparison.html">ROS to ROS2 Navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#id1">About</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#contact">Contact</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Navigation 2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Tutorials</a> &raquo;</li>
        
      <li>(STVL) Using an External Costmap Plugin</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="stvl-using-an-external-costmap-plugin">
<span id="stvl"></span><h1>(STVL) Using an External Costmap Plugin<a class="headerlink" href="#stvl-using-an-external-costmap-plugin" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#costmap2d-and-stvl">Costmap2D and STVL</a></li>
<li><a class="reference internal" href="#tutorial-steps">Tutorial Steps</a></li>
</ul>
<h1 align="center">
  <div style="position: relative; padding-bottom: 0%; overflow: hidden; max-width: 100%; height: auto;">
    <iframe width="700" height="450" src="https://www.youtube.com/embed/TGxb1OzgmNQ?autoplay=1" frameborder="1" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </div>
</h1><div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This tutorial shows how to load and use an external plugin.
This example uses the <a class="reference external" href="https://github.com/SteveMacenski/spatio_temporal_voxel_layer/">Spatio Temporal Voxel Layer</a> (STVL) costmap <a class="reference external" href="http://wiki.ros.org/pluginlib/">pluginlib</a> plugin as an example.
STVL is a demonstrative pluginlib plugin and the same process can be followed for other costmap plugins as well as plugin planners, controllers, and recoveries.</p>
<p>Before completing this tutorial, please look at the previous two tutorials on navigation in simulation and physical hardware, if available.
This tutorial assumes knowledge of navigation and basic understanding of costmaps.</p>
</div>
<div class="section" id="costmap2d-and-stvl">
<h2>Costmap2D and STVL<a class="headerlink" href="#costmap2d-and-stvl" title="Permalink to this headline">¶</a></h2>
<p>Costmap 2D is the data object we use to buffer sensor information into a global view that the robot will use to create plans and control efforts.
Within Costmap2D, there are pluginlib plugin interfaces available to create custom behaviors loadable at runtime.
Examples of included pluginlib plugins for Costmap2D are the Obstacle Layer, Voxel Layer, Static Layer, and Inflation Layer.</p>
<p>However, these are simply example plugins offered by the base implementation.
Another available pluginlib plugin for Costmap2D in Navigation2 is STVL.</p>
<p>STVL is another 3D perception plugin similar to the Voxel Layer.
A more detailed overview of how it works can be found <a class="reference external" href="https://github.com/SteveMacenski/spatio_temporal_voxel_layer/">in this repo</a>, however it buffers 3D data from depth cameras, sonars, lidars, and more into a sparse volumetic world model and removes voxels over time proportional with a sensor model and time-based expiration.
This can be especially useful for robots in highly dynamic envrionments and decreases the resource utilization for 3D sensor processing by up to 2x.
STVL also treats 3D lidars and radars as first class citizens for support.
The ROSCon talk for STVL can be found <a class="reference external" href="https://vimeo.com/292699571">in this video</a>.</p>
</div>
<div class="section" id="tutorial-steps">
<h2>Tutorial Steps<a class="headerlink" href="#tutorial-steps" title="Permalink to this headline">¶</a></h2>
<div class="section" id="setup">
<h3>0- Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h3>
<p>Follow the same process as in <a class="reference internal" href="../../getting_started/index.html#getting-started"><span class="std std-ref">Getting Started</span></a> for installing and setting up a robot for hardware testing or simulation, as applicable. Ensure ROS2, Navigation2, and Gazebo are installed.</p>
</div>
<div class="section" id="install-stvl">
<h3>1- Install STVL<a class="headerlink" href="#install-stvl" title="Permalink to this headline">¶</a></h3>
<p>STVL can be installed in ROS2 via the ROS Build Farm:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt</span> <span class="pre">install</span> <span class="pre">ros-&lt;ros2-distro&gt;-spatio-temporal-voxel-layer</span></code></li>
</ul>
<p>It can also be built from source by cloning the repository into your Navigation2 workspace:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">-b</span> <span class="pre">&lt;ros2-distro&gt;-devel</span> <span class="pre">git&#64;github.com:stevemacenski/spatio_temporal_voxel_layer</span></code></li>
</ul>
</div>
<div class="section" id="modify-navigation2-parameter">
<h3>1- Modify Navigation2 Parameter<a class="headerlink" href="#modify-navigation2-parameter" title="Permalink to this headline">¶</a></h3>
<p>STVL is an optional plugin, like all plugins, in Costmap2D. Costmap Plugins in Navigation2 are loaded in the <code class="docutils literal notranslate"><span class="pre">plugin_names</span></code> and <code class="docutils literal notranslate"><span class="pre">plugin_types</span></code> variables inside of their respective costmaps.
For example, the following will load the static and obstacle layer plugins into the name <code class="docutils literal notranslate"><span class="pre">static_layer</span></code> and <code class="docutils literal notranslate"><span class="pre">obstacle_layer</span></code>, respectively:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">global_costmap</span><span class="p">:</span>
  <span class="nt">global_costmap</span><span class="p">:</span>
    <span class="nt">ros__parameters</span><span class="p">:</span>
      <span class="nt">use_sim_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">plugin_names</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;static_layer&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;obstacle_layer&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">plugin_types</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;nav2_costmap_2d::StaticLayer&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;nav2_costmap_2d::ObstacleLayer&quot;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>To load the STVL plugin, a new plugin name and type must be added.
For example, if the application required an STVL layer and no obstacle layer, our file would be:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">global_costmap</span><span class="p">:</span>
  <span class="nt">global_costmap</span><span class="p">:</span>
    <span class="nt">ros__parameters</span><span class="p">:</span>
      <span class="nt">use_sim_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">plugin_names</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;static_layer&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;stvl_layer&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">plugin_types</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;nav2_costmap_2d::StaticLayer&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;spatio_temporal_voxel_layer/SpatioTemporalVoxelLayer&quot;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Similar to the Voxel Layer, after registering the plugin, we can add the configuration of the STVL layer under the namespace <code class="docutils literal notranslate"><span class="pre">stvl_layer</span></code>.
An example fully-described parameterization of an STVL configuration is:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">stvl_layer</span><span class="p">:</span>
  <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="nt">voxel_decay</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15.</span>
  <span class="nt">decay_model</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
  <span class="nt">voxel_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.05</span>
  <span class="nt">track_unknown_space</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="nt">max_obstacle_height</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2.0</span>
  <span class="nt">unknown_threshold</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>
  <span class="nt">mark_threshold</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
  <span class="nt">update_footprint_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="nt">combination_method</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class="nt">obstacle_range</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3.0</span>
  <span class="nt">origin_z</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.0</span>
  <span class="nt">publish_voxel_map</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="nt">transform_tolerance</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.2</span>
  <span class="nt">mapping_mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class="nt">map_save_duration</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">60.0</span>
  <span class="nt">observation_sources</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pointcloud</span>
  <span class="nt">pointcloud</span><span class="p">:</span>
    <span class="nt">data_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PointCloud2</span>
    <span class="nt">topic</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/intel_realsense_r200_depth/points</span>
    <span class="nt">marking</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">clearing</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">min_obstacle_height</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.0</span>
    <span class="nt">max_obstacle_height</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2.0</span>
    <span class="nt">expected_update_rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.0</span>
    <span class="nt">observation_persistence</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.0</span>
    <span class="nt">inf_is_valid</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">voxel_filter</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">clear_after_reading</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">max_z</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7.0</span>
    <span class="nt">min_z</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
    <span class="nt">vertical_fov_angle</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.8745</span>
    <span class="nt">horizontal_fov_angle</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1.048</span>
    <span class="nt">decay_acceleration</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15.0</span>
    <span class="nt">model_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
</pre></div>
</div>
<p>Please copy-paste the text above, with the <code class="docutils literal notranslate"><span class="pre">plugin_names</span></code> and <code class="docutils literal notranslate"><span class="pre">plugin_types</span></code> registration, into your <code class="docutils literal notranslate"><span class="pre">nav2_params.yaml</span></code> to enable STVL in your application.
Make sure to change both the local and global costmaps.</p>
<p>Note: Pluginlib plugins for other Navigation2 servers such as planning, recovery, and control can be set in this same way.</p>
</div>
<div class="section" id="launch-navigation2">
<h3>2- Launch Navigation2<a class="headerlink" href="#launch-navigation2" title="Permalink to this headline">¶</a></h3>
<p>Follow the same process as in <a class="reference internal" href="../../getting_started/index.html#getting-started"><span class="std std-ref">Getting Started</span></a> to launch a simulated robot in gazebo with Navigation2.
Navigation2 is now using STVL as its 3D sensing costmap layer.</p>
</div>
<div class="section" id="rviz">
<h3>3-  RVIZ<a class="headerlink" href="#rviz" title="Permalink to this headline">¶</a></h3>
<p>With RViz open and <code class="docutils literal notranslate"><span class="pre">publish_voxel_map:</span> <span class="pre">true</span></code>, you can visualize the underlying data structure’s 3D grid using the <code class="docutils literal notranslate"><span class="pre">{local,</span> <span class="pre">global}_costmap/voxel_grid</span></code> topics.
Note: It is recommended in RViz to set the <code class="docutils literal notranslate"><span class="pre">PointCloud2</span></code> Size to your voxel size and the style to <code class="docutils literal notranslate"><span class="pre">Boxes</span></code> with a neutral color for best visualization.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  

<script type="text/javascript" src="../../_static/tcs_theme.js"></script>



</body>
</html>